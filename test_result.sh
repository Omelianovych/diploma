#!/bin/bash

# –§–∞–π–ª —Å –ª–æ–≥–∞–º–∏ (–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ –æ–Ω –ª–µ–∂–∏—Ç —Ä—è–¥–æ–º)
LOGFILE="logs"

if [ ! -f "$LOGFILE" ]; then
  echo "‚ùå –§–∞–π–ª $LOGFILE –Ω–µ –Ω–∞–π–¥–µ–Ω!"
  exit 1
fi

echo "üîç –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–æ–≤ –¥–ª—è –¥–∏–ø–ª–æ–º–Ω–æ–π —Ä–∞–±–æ—Ç—ã..."
echo "---------------------------------------------------"

# Grep –∏—â–µ—Ç:
# 1. diploma_test_openat (–Ω–∞—à openat)
# 2. COMM:curl (–Ω–∞—à execve –∏ connect)
# 3. COMM:ls (–Ω–∞—à execve)
# 4. python3.*PORT:8000 (–Ω–∞—à accept, –ø–æ—Ä—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å 8000 –∏–ª–∏ –æ–±—Ä–∞—Ç–Ω—ã–π)

# –ò—Å–ø–æ–ª—å–∑—É–µ–º grep -a (treat binary as text) –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –≤ –ª–æ–≥–∞—Ö –µ—Å—Ç—å –º—É—Å–æ—Ä
grep -a -E "diploma_test_openat|COMM:curl|COMM:ls|python3.*:8000|COMM:python3.*FD:" "$LOGFILE"

echo "---------------------------------------------------"
echo "‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞."
